CREATE DATABASE EXERCISE3 

USE EXERCISE3; 

  

DROP TABLE EMPLOYEE; 

  

CREATE TABLE EMPLOYEE(EMPID INT, EMPNAME VARCHAR(20), DEPTID INT, SALARY INT); 

CREATE TABLE DEPT (DEPTID INT, DEPTNAME VARCHAR(20)); 

INSERT INTO EMPLOYEE VALUES (1,"JOHN",101,1000); 

INSERT INTO EMPLOYEE VALUES (2,"MANO",102,2000); 

INSERT INTO EMPLOYEE VALUES (3,"PRAKASH",101,3000); 

INSERT INTO EMPLOYEE VALUES (4,"VENU",102,4500); 

INSERT INTO EMPLOYEE VALUES (5,"ABIRAMI",101,5000); 

INSERT INTO DEPT VALUES(101,"HR"); 

INSERT INTO DEPT VALUES(102,"TESTING"); 

INSERT INTO DEPT VALUES(103,"DEVELOPMENT"); 

INSERT INTO DEPT VALUES(104,"ACCOUNTS"); 

  

SELECT EMPNAME FROM EMPLOYEE WHERE DEPTID=(SELECT DEPTID FROM DEPT WHERE DEPTNAME='TESTING'); 

  

SELECT COUNT(EMPNAME) FROM EMPLOYEE WHERE DEPTID=(SELECT DEPTID FROM DEPT WHERE DEPTNAME='ACCOUNTS'); 

  

SELECT DEPTNAME FROM DEPT WHERE DEPTID=(SELECT DEPTID FROM EMPLOYEE WHERE EMPNAME='JOHN'); 

  

SELECT DEPTNAME FROM DEPT WHERE DEPTID=(SELECT DEPTID FROM EMPLOYEE WHERE SALARY=(SELECT MAX(SALARY) FROM EMPLOYEE)); 

  

SELECT DEPTNAME FROM DEPT WHERE DEPTID=(SELECT DEPTID FROM EMPLOYEE WHERE SALARY=(SELECT MIN(SALARY) FROM EMPLOYEE)); 

  

SELECT DEPTNAME FROM DEPT WHERE DEPTID=(SELECT DEPTID  

FROM EMPLOYEE GROUP BY DEPTID HAVING COUNT(DEPTID) >= ALL(SELECT COUNT(DEPTID) FROM EMPLOYEE GROUP BY DEPTID)); 

  

SELECT DEPTNAME FROM DEPT WHERE DEPTID NOT IN (SELECT DEPTID FROM EMPLOYEE); 

  

SELECT EMPNAME FROM EMPLOYEE WHERE DEPTID NOT IN(SELECT DEPTID FROM DEPT WHERE DEPTNAME="HR"); 

  

SELECT EMPNAME FROM EMPLOYEE WHERE SALARY=(SELECT SALARY FROM EMPLOYEE ORDER BY SALARY DESC LIMIT 1,1); 

  

SELECT EMPNAME FROM EMPLOYEE WHERE SALARY>(SELECT SALARY FROM EMPLOYEE WHERE EMPNAME='MANO'); 

  

SELECT EMPNAME FROM EMPLOYEE 

WHERE SALARY=(SELECT MAX(SALARY) FROM EMPLOYEE GROUP BY DEPTID HAVING DEPTID=(SELECT DEPTID FROM DEPT WHERE DEPTNAME='TESTING')); 

  

SELECT EMPID,EMPNAME,DEPTNAME FROM EMPLOYEE INNER JOIN DEPT ON DEPT.DEPTID=EMPLOYEE.DEPTID; 

  

SELECT DEPTID,DEPTNAME FROM DEPT WHERE DEPTID NOT IN (SELECT DEPTID FROM EMPLOYEE); 