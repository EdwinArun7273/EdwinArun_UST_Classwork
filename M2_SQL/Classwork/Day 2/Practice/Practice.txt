CREATE DATABASE PRACTICE2; 

  

USE PRACTICE2; 

  

CREATE TABLE BOOKS(BOOKID INT, BOOKNAME VARCHAR(20), PRICE INT); 

INSERT INTO BOOKS VALUES(1, 'C', 100); 

INSERT INTO BOOKS VALUES(2, 'C++', 200); 

INSERT INTO BOOKS VALUES(3, 'JAVA', 300); 

  

CREATE TABLE TRANSACTIONS(TRANSACTIONID INT,BOOKID INT); 

INSERT INTO TRANSACTIONS VALUES(101, 1); 

INSERT INTO TRANSACTIONS VALUES(102, 1); 

INSERT INTO TRANSACTIONS VALUES(103, 1); 

  

SELECT * FROM BOOKS INNER JOIN TRANSACTIONS ON BOOKS.BOOKID = TRANSACTIONS.BOOKID; 

  

SELECT BOOKS.BOOKID,BOOKS.BOOKNAME,TRANSACTIONS.TRANSACTIONID FROM BOOKS LEFT JOIN TRANSACTIONS ON BOOKS.BOOKID = TRANSACTIONS.BOOKID;  

  

SELECT * FROM BOOKS CROSS JOIN TRANSACTIONS; 

  

CREATE TABLE EMPLOYEE(EMPID INT, EMPNAME VARCHAR(20) ,MANAGERID INT); 

INSERT INTO EMPLOYEE VALUES(1, 'USER1', 4); 

INSERT INTO EMPLOYEE VALUES(2, 'USER2', 3); 

INSERT INTO EMPLOYEE VALUES(3, 'USER3', 1); 

INSERT INTO EMPLOYEE VALUES(4,'USER4',2); 

  

SELECT * FROM EMPLOYEE E1, EMPLOYEE E2 WHERE E1.EMPID = E2.MANAGERID; 

  

CREATE TABLE EMP(EMPID INT, EMPNAME VARCHAR(20), SALARY INT, DEPTID INT); 

INSERT INTO EMP VALUES(1, 'USER1', 1000, 101); 

INSERT INTO EMP VALUES(2, 'USER2', 2000, 101); 

INSERT INTO EMP VALUES(3, 'USER3', 3000, 101); 

  

SELECT EMPID,EMPNAME,DEPTID FROM EMP 

WHERE DEPTID= ANY(SELECT DEPTID FROM DEPT WHERE DPTNAME = 'TESTING' OR DEPTNAME = 'HR'); 

  

SELECT EMPID,EMPNAME,SAL FROM EMP E1 WHERE SAL > (SELECT AVG(SAL) FROM EMO E2 WHERE E1.DEPTID = E2.DEPTID); 

  

  

CREATE TABLE TESTINDEX(ID INT PRIMARY KEY,FNAME VARCHAR(20)); 

INSERT INTO TESTINDEX VALUES(1, 'USER1'); 

INSERT INTO TESTINDEX VALUES(3, 'USER3'); 

INSERT INTO TESTINDEX VALUES(2, 'USER2'); 

SELECT * FROM TESTINDEX; 

  

SHOW INDEX FROM TESTINDEX; 

CREATE INDEX MYINDEX ON TESTINDEX(FNAME); 

  

DELIMITER // 

CREATE PROCEDURE P1() 

BEGIN 

	SELECT * FROM EMP; 

END // 

DELIMITER ; 

CALL P1 

  

DELIMITER // 

CREATE PROCEDURE P2(A INT,B INT) 

BEGIN  

	SELECT 'SUM IS'+(A+B); 

END // 

DELIMITER ; 

CALL P2(2,3) 

  

DROP PROCEDURE P3; 

  

DELIMITER // 

CREATE PROCEDURE P3(A INT) 

BEGIN  

	SELECT * FROM EMP WHERE EMPID=A; 

END // 

DELIMITER ; 

CALL P3(1); 

  

DELIMITER // 

CREATE TRIGGER T1 AFTER INSERT ON EMP FOR EACH ROW 

BEGIN 

	SET @COUNT='RECORD ADDED'; 

END // 

DELIMITER ; 

INSERT INTO EMP VALUES(5,'USE5',23000,102); 

SELECT @COUNT; 

  

  

DELIMITER // 

CREATE TRIGGER T2 AFTER DELETE ON EMP FOR EACH ROW 

BEGIN 

	SET @COUNT='RECORD DELETED'; 

END // 

DELIMITER ; 

DELETE FROM EMP WHERE SALARY=23000; 

SELECT @COUNT; 

  

CREATE VIEW V1 AS SELECT EMPID,EMPNAME FROM EMP; 

SELECT * FROM V1; 


DROP VIEW V2; 
