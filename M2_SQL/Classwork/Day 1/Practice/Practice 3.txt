SUB QUERIES

CREATE DATABASE PRACTICE3;
USE PRACTICE3;

CREATE TABLE DEPT(DEPTID INT, DEPTNAME VARCHAR(20));
INSERT INTO DEPT VALUES(1, 'HR');
INSERT INTO DEPT VALUES(2, 'TESTING');
INSERT INTO DEPT VALUES(3, 'DEVELOPMENT');
INSERT INTO DEPT VALUES(4, 'ACCOUNTS');
INSERT INTO DEPT VALUES(5, 'ADMIN');

CREATE TABLE EMP(EMPID INT, EMPNAME VARCHAR(20), SAL INT, DEPTID INT);
INSERT INTO EMP VALUES(101, 'JOHN', 10000, 1);
INSERT INTO EMP VALUES(102, 'PRAKASH', 25000, 2);
INSERT INTO EMP VALUES(103, 'GOWRI', 12000, 2);
INSERT INTO EMP VALUES(104, 'KRISHNAN', 15000, 1);
INSERT INTO EMP VALUES(105, 'KUMAR', 28000, 3);

SELECT DEPTNAME FROM DEPT WHERE DEPTID=(SELECT DEPTID FROM EMP WHERE EMPNAME='PRAKASH');
SELECT COUNT(EMPID) FROM EMP WHERE DEPTID=(SELECT DEPTID FROM DEPT WHERE DEPTNAME = 'HR');
SELECT EMPNAME FROM EMP WHERE DEPTID=(SELECT DEPTID FROM DEPT WHERE DEPTNAME = 'TESTING') AND SAL = (SELECT MAX(SAL) FROM EMP WHERE DEPTID = (SELECT DEPTID FROM DEPT WHERE DEPTNAME = 'TESTING'));
SELECT DEPTNAME FROM DEPT WHERE DEPTID NOT IN(SELECT DEPTID FROM EMP);
SELECT EMPNAME FROM EMP D WHERE SAL<(SELECT AVG(SAL) FROM EMP E WHERE D.DEPTID = E.DEPTID);
SELECT EMPNAME FROM EMP E WHERE SAL=(SELECT MAX(SAL) FROM EMP  WHERE E.DEPTID = DEPTID);
SELECT DEPTNAME FROM DEPT WHERE DEPTID IN (SELECT DEPTID FROM EMP WHERE EMPNAME='KRISHNAN'OR EMPNAME='KUMAR');
SELECT EMPNAME FROM EMP WHERE DEPTID IN (SELECT DEPTID FROM DEPT WHERE DEPTNAME='TESTING') AND SAL > 12000;