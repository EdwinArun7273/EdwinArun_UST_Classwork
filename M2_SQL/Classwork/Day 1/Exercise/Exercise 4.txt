CREATE DATABASE EXERCISE4;
USE EXERCISE4;

CREATE TABLE STUDENTS(ROLLNO INT, STUDENTNAME VARCHAR(20));
INSERT INTO STUDENTS VALUES(1, 'JOHN');
INSERT INTO STUDENTS VALUES(2, 'PRAKASH');
INSERT INTO STUDENTS VALUES(3, 'MANO');
INSERT INTO STUDENTS VALUES(4, 'RAGHAV');
INSERT INTO STUDENTS VALUES(5, 'KUMAR');

CREATE TABLE COURSES(COURSENO VARCHAR(20), COURSENAME VARCHAR(20), FEE INT);
INSERT INTO COURSES VALUES('C001', 'DOS', 1500);
INSERT INTO COURSES VALUES('C002', 'MSWINDOWS', 2000);
INSERT INTO COURSES VALUES('C003', 'C++', 3000);
INSERT INTO COURSES VALUES('C004', 'C', 2000);
INSERT INTO COURSES VALUES('C005', 'JAVA', 3000);
INSERT INTO COURSES VALUES('C006', 'ORACLE', 4000);

CREATE TABLE COURSESENROLLED(ROLLNO INT, COURSENO VARCHAR(20));
INSERT INTO COURSESENROLLED VALUES(1, 'C001');
INSERT INTO COURSESENROLLED VALUES(1, 'C004');
INSERT INTO COURSESENROLLED VALUES(2, 'C003');
INSERT INTO COURSESENROLLED VALUES(5, 'C006');

SELECT COURSENAME FROM COURSES WHERE COURSENO IN (SELECT COURSENO FROM COURSESENROLLED WHERE ROLLNO = (SELECT ROLLNO FROM STUDENTS WHERE STUDENTNAME='JOHN'));
SELECT COURSENAME FROM COURSES WHERE FEE>3500;
SELECT COURSENAME FROM COURSES WHERE COURSENO NOT IN (SELECT COURSENO FROM COURSESENROLLED GROUP BY COURSENO);
SELECT FEE FROM COURSES WHERE COURSENO = 'C004';
SELECT COUNT(COURSENO) FROM COURSESENROLLED WHERE ROLLNO = (SELECT ROLLNO FROM STUDENTS WHERE STUDENTNAME = 'PRAKASH');
SELECT COURSENAME FROM COURSES WHERE COURSENO IN (SELECT COURSENO FROM COURSESENROLLED);
SELECT STUDENTNAME FROM STUDENTS WHERE ROLLNO IN (SELECT ROLLNO FROM COURSESENROLLED GROUP BY ROLLNO HAVING COUNT(ROLLNO)>1);
SELECT STUDENTNAME FROM STUDENTS WHERE ROLLNO IN (SELECT ROLLNO FROM COURSESENROLLED WHERE COURSENO IN (SELECT COURSENO FROM COURSES WHERE COURSENAME='ORACLE'));